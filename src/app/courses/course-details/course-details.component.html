<div class="course-container">
  <!-- Шапка курса -->
  <div class="course-header">
    <div>
      <h1>{{ course?.name }}</h1>
      <p class="course-description">{{ course?.description }}</p>

      <div class="course-meta">
        <div>
          <mat-icon>person</mat-icon>
          <span>Преподаватель: {{ course?.teacher?.name }}</span>
        </div>
        <div>
          <mat-icon>date_range</mat-icon>
          <span>
            {{ course?.duration?.startDate | date : "dd.MM.yyyy" }} -
            {{ course?.duration?.endDate | date : "dd.MM.yyyy" }}
          </span>
        </div>
        <div>
          <mat-icon>school</mat-icon>
          <span>Уроков: {{ course?.lessons?.length }}</span>
        </div>
      </div>
    </div>

    <div class="course-progress">
      <mat-progress-spinner
        [value]="getCourseProgress()"
        [color]="getProgressColor()"
        mode="determinate"
      ></mat-progress-spinner>
      <span>{{ getCourseProgress() }}%</span>
    </div>
  </div>

  <!-- Список уроков -->
  <mat-accordion class="lessons-accordion">
    <mat-expansion-panel *ngFor="let lesson of course?.lessons; index as i">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Урок {{ i + 1 }}: {{ lesson.lessonName }}
        </mat-panel-title>
        <mat-panel-description>
          {{ lesson.date | date : "dd.MM.yyyy" }}
        </mat-panel-description>
      </mat-expansion-panel-header>

      <!-- Материалы урока -->
      <div class="lesson-content">
        <h3>Материалы</h3>
        <p>{{ lesson.description }}</p>

        <div *ngIf="lesson.material" class="materials">
          <a mat-stroked-button [href]="lesson.material.url" download>
            <mat-icon>download</mat-icon>
            Скачать материалы
          </a>
        </div>
      </div>

      <!-- Домашние задания -->
      <div *ngIf="lesson.homeTasks.length" class="home-tasks">
        <h3>Домашние задания</h3>

        <mat-card *ngFor="let task of lesson.homeTasks" class="task-card">
          <mat-card-header>
            <mat-card-title>{{ task.homeTaskName }}</mat-card-title>
            <mat-card-subtitle>
              Дедлайн: {{ task.duration.endDate | date : "dd.MM.yyyy" }}
            </mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <p>{{ task.description }}</p>
          </mat-card-content>

          <mat-card-actions>
            <button mat-button (click)="openTaskDialog(task)">
              <mat-icon>send</mat-icon>
              Отправить решение
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>
